{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "NG Entry & Profit Analyzer - Input Schema",
  "type": "object",
  "required": ["ticker", "historical_data", "current_analysis_period"],
  "properties": {
    "ticker": {
      "type": "string",
      "pattern": "^[A-Z]{2}[0-9]?!?$|^[A-Z]{3}[0-9]{2}$",
      "description": "Natural Gas contract symbol (NG1!, NGH26, etc.)",
      "examples": ["NG1!", "NGH26", "NGM26"]
    },
    "figi": {
      "type": "string",
      "pattern": "^BBG[A-Z0-9]{9}$",
      "description": "Optional: FIGI identifier. If not provided, resolved from contracts.yaml",
      "examples": ["BBG000N4R6V1"]
    },
    "contracts_yaml_path": {
      "type": "string",
      "default": "src/contracts.yaml",
      "description": "Path to contracts mapping file"
    },
    "historical_data": {
      "oneOf": [
        {
          "type": "string",
          "description": "Path to CSV/JSON file with OHLCV data",
          "examples": ["data/ng_history.csv"]
        },
        {
          "type": "object",
          "required": ["source"],
          "properties": {
            "source": {
              "enum": ["yahoo_fin", "investing_com"],
              "description": "Data source type"
            },
            "symbol": {
              "type": "string",
              "description": "Symbol for yahoo_fin",
              "examples": ["NG=F"]
            },
            "period": {
              "type": "string",
              "pattern": "^[0-9]+(mo|d)$",
              "description": "Period for yahoo_fin (e.g., 18mo, 365d)"
            },
            "url": {
              "type": "string",
              "format": "uri",
              "description": "URL for investing_com scraper"
            },
            "scrape_days": {
              "type": "integer",
              "minimum": 252,
              "description": "Days to scrape (min 252 = 12 months trading days)"
            }
          }
        }
      ]
    },
    "current_analysis_period": {
      "type": "integer",
      "minimum": 14,
      "maximum": 180,
      "default": 60,
      "description": "Lookback window in days for current analysis"
    },
    "strategy_style": {
      "type": "string",
      "enum": ["breakout_aggressive", "breakout_conservative"],
      "default": "breakout_aggressive",
      "description": "Breakout entry style"
    },
    "max_risk_percent": {
      "type": "number",
      "minimum": 0.5,
      "maximum": 5.0,
      "default": 2.0,
      "description": "Maximum portfolio risk per trade (%)"
    },
    "eia_data": {
      "type": ["object", "null"],
      "properties": {
        "report_date": {
          "type": "string",
          "format": "date",
          "description": "EIA report date (YYYY-MM-DD)"
        },
        "net_change_bcf": {
          "type": "number",
          "description": "Net change in storage (billion cubic feet)"
        },
        "total_storage_bcf": {
          "type": "number",
          "minimum": 0,
          "description": "Total storage level (bcf)"
        }
      },
      "required": ["report_date", "net_change_bcf", "total_storage_bcf"]
    },
    "timezone": {
      "type": "string",
      "default": "Europe/Moscow",
      "description": "IANA timezone identifier",
      "examples": ["Europe/Moscow", "UTC", "America/New_York"]
    },
    "output_format": {
      "type": "string",
      "enum": ["json", "json+telegram"],
      "default": "json",
      "description": "Output format"
    }
  }
}
